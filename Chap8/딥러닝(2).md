## 딥러닝 고속화

- 딥러닝에서는 **대량의 연산을 수행**하기 위해 CPU만으로 부족하기 때문에 **GPU와 여러 기기로 분산 수행**함 

- **합성곱 계층(단일 곱셈-누산)에서 오랜 시간을 소요**하는데 이것을 어떻게 **고속으로, 효율적으로 계산**하느냐는 것

 #### GPU 컴퓨팅

대량 병렬 연산을 잘 처리하는(CPU는 연속적이고 복잡한 계산을 잘 처리) GPU의 특성을 이용해 그래픽 처리뿐 아니라 **범용 수치 연산**에 이용하는 것

<img src="https://user-images.githubusercontent.com/58063806/90362348-60fd7f00-e09b-11ea-84bb-453cf8044d14.JPG" width=60% />

16코어 제온 CPU에서는 40여 일이 걸리지만 타이탄 GPU로는 6일까지 단축된 것을 볼 수 있음

cuDNN이라는 딥러닝 최적화 라이브러리를 사용하면 더욱 빨라짐

 ### 분산 학습

딥러닝 학습을 수평 확장하자는 아이디어(**다수의 GPU와 기기로 계산을 분산**)

구글의 텐서플로, MS의 CNTK - 분산 학습을 지원한 딥러닝 프레임워크

<img src="C:\Users\0864h\AppData\Roaming\Typora\typora-user-images\image-20200817151406463.png" width=70% />

위의 결과를 보면 **GPU 100개를 사용하면 하나를 사용할 때 보다 56배 빨라진 것**을 볼 수 있음  

### 연산 정밀도와 비트 줄이기

- 대량의 가중치 매개변수와 중간 데이터를 메모리에 저장해야 함

- 메모리 용량과 버스 대역폭 등이 딥러닝 고속화에 병목이 될 수 있음

- GPU(or CPU)의 버스를 흐르는 데이터가 많아져 한계를 넘어서면 병목

  **=> 네트워크로 주고받는 데이터의 비트수를 최소로 만드는 것이 바람직**

**신경망의 견고성 - 높은 수치 정밀도를 요구하지 않음(신경망을 흐르는 데이터를 퇴화시켜도 출력에 주는 영향은 적음)**

신경망의 견고성 때문에 딥러닝은 **16비트 배정밀도**만 사용해도 학습에 문제가 없다고 알려져 있음

## 딥러닝의 활용

### 사물 검출

이미지 전체를 대상으로 한 사물 인식에 비해 **이미지 어딘가에 있는 사물의 위치**를 알아내야 하고 **한 이미지에 여러 사물이 존재할 수도 있으므로** 더 어려운 문제임

#### R-CNN

<img src="https://user-images.githubusercontent.com/58063806/90363869-5db7c280-e09e-11ea-9562-dae877ef72e9.JPG" width=80% />

- **후보 영역 추출**에서 사물이 위치한 영역을 찾아냄
- **CNN 특징 계산**에서 추출한 각 영역에 CNN을 적용해서 클래스를 분류

### 분할

이미지를 픽셀 수준에서 분류하는 문제로 픽셀 단위로 객체마다 채색된 지도 데이터를 사용해 학습

<img src="https://user-images.githubusercontent.com/58063806/90364663-6a88e600-e09f-11ea-94fe-c26f0398a8d7.JPG" width=70% />

#### FCN

- 합성곱 계층만으로 구성된 네트워크

- 한 번의 forward 처리로 모든 픽셀의 클래스를 분류해주는 기법 

<img src="https://user-images.githubusercontent.com/58063806/90364818-bb004380-e09f-11ea-832e-f448f56de272.JPG" width=60% />

중간 데이터의 공간 볼륨(다차원 형태)을 1차원으로 변환하여 한 줄로 늘어선 노드들이 처리한 완전연결 계층과 달리 **FCN에서는 공간 볼륨을 유지한 채 마지막 출력까지 처리** 

**마지막에 공간 크기를 확대하는 처리(이중 선형 보간에 의한 선형 확대)**를 도입**(줄어든 중간 데이터를 입력 이미지와 같은 크기로 단번에 확대)**

### 사진 캡션 생성

사진이 주어지면 그 사진에 대한 설명글(사진 캡션)을 자동으로 생성

<img src="C:\Users\0864h\AppData\Roaming\Typora\typora-user-images\image-20200817154925864.png" width=70% />

#### NIC

심층 CNN과 자연어를 다루는 순환 신경망으로 구성

**순환 신경망(RNN) - 이전에 생성한 정보에 영향을 받으며(과거의 정보를 기억) 자연어나 시계열 데이터 등의 연속된 데이터를 다를 때 많이 활용** 

<img src="https://user-images.githubusercontent.com/58063806/90366067-d8cea800-e0a1-11ea-89ee-c651c957ac5c.JPG" width=70% />

**CNN으로 사진에서 특징을 추출하고 RNN은 이러한 특징을 초기값으로 해서 텍스트를 순환적으로 생성** 

**멀티모탈 처리 - 사진이나 자연어와 같은 여러 종류의 정보를 조합하고 처리하는 것**

