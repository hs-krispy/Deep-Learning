## 계산 그래프

가중치 매개변수의 기울기를 효율적으로 계산하는 **오차역전파법**의 계산 과정을 그래프(노드, 엣지로 표현)로 나타낸 것

이때 계산은 왼쪽에서 오른쪽으로 진행**(순전파)**함 <=> 오른쪽에서 왼쪽으로 진행**(역전파)**

**국소적 계산** - 전체에서 어떤 일이 벌어지든 상관없이 자신과 관계된 정보만으로 결과를 출력

(복잡한 계산도 **국소적인 계산으로 분할해서 단순화**시킴, 각 노드는 **자신과 관련한 계산만 신경쓰면 됨**, **중간 계산 결과 모두 보관** 가능)

<img src="https://user-images.githubusercontent.com/58063806/89120160-fe2eb400-d4ee-11ea-972b-b3c519726434.JPG" width=70% />

**역전파에 의한 미분(사과 가격에 대한 지불 금액의 미분)**

<img src="https://user-images.githubusercontent.com/58063806/89120161-ff5fe100-d4ee-11ea-9e48-45607b5db772.JPG" width=70% />

오른쪽에서 왼쪽으로 미분 값을 전달(1 -> 1.1 -> 2.2)

**사과 가격에 대한 지불 금액의 미분 값은 2.2(사과가 일정 금액오르면 최종금액은 그 금액의 2.2배 만큼 오름)**

## 연쇄 법칙

합성함수 - 여러 함수로 구성된 함수

z = (x + y)^2 **(z = t^2, t = x + y 두 함수에 의해 구성)**

**함성 함수의 미분은 합성 함수를 구성하는 각 함수의 미분의 곱으로 나타낼 수 있음**

<img src="https://user-images.githubusercontent.com/58063806/89124863-2af5c200-d515-11ea-9d9c-82aeaeb80713.JPG" width=30% />

**x에 대한 z의 미분 - 2t x 1 = 2t = 2(x + y)**

**계산그래프의 역전파**

<img src="https://user-images.githubusercontent.com/58063806/89124935-afe0db80-d515-11ea-88fb-4bf446887361.JPG" width=60% />

## 역전파

최종적으로 L이라는 값을 출력하는 계산 그래프를 가정

### 덧셈 노드의 역전파

<img src="https://user-images.githubusercontent.com/58063806/89125013-4c0ae280-d516-11ea-8795-b5d73dc271f0.JPG" width=60% />

**x에 대한 z의 미분 = y에 대한 z의 미분 = 1**

덧셈 노드 역전파는 **입력 신호를 다음 노드로 출력(x 1)**

### 곱셈 노드의 역전파

<img src="https://user-images.githubusercontent.com/58063806/89125164-5ed1e700-d517-11ea-8a7b-654386168a39.JPG" width=60% /> 

**x에 대한 z의 미분 = y**

**y에 대한 z의 미분 = x**

곱셈 노드 역전파는 **입력 신호를 서로 바꾼 값을 곱함(순방향 입력 신호의 값이 필요함)**

<img src="https://user-images.githubusercontent.com/58063806/89125360-d18f9200-d518-11ea-994f-efae38317146.JPG" width=70% />

**사과의 가격이 일정 금액오르면 최종금액은 그 금액의 2.2배 만큼 오름**

**귤의 가격이 일정 금액오르면 최종금액은 그 금액의 3.3배 만큼 오름**

**사과의 개수가 일정 개수오르면 최종금액은 그 개수 x 110 만큼 오름**

**귤의 개수가 일정 개수오르면 최종금액은 그 개수 x 165 만큼 오름**

**소비세가 일정 비율상승하면 최종금액은 그 비율 x 650 만큼 오름**